{% extends "base.html" %}
{% load i18n %}
{% load statistics_happix %}

{% block breadcrumb %}

{{block.super}} »
<a href="{% url project_list_recent %}">{% trans "Projects" %}</a> » 
<a href="{% url project_detail project.slug %}">{{project}}</a> »
<a href="{% url project.resource project.slug tresource.slug %}">{{tresource}}</a>
{% endblock %}

{% block title %}
{{ block.super }} |
Projects |
{{project}}
{{tresource}}
{% endblock %}

{% block body_class %}project_list{% endblock %}

{% block content_title %}


{% endblock %}

{% block content %}

<script type="text/javascript">
	$(document).ready(function(){
		$(".tipsy_enable").tipsy({'html':true, 'gravity':'s'});
        $("#new_translation").click( function (){ 
            $("#new_translation_box").toggle();
        });
        $("#start_new_translation").click( function() {
            var target_lang_code = $(this).prev().val();
            if ( target_lang_code != "" ) {
                request_url = window.location + target_lang_code;
                window.location = request_url;
            } else {
                alert("Please select a target language first and then click crate.");
            }
        });
	});
</script>

{% if request.user.is_authenicated %}
{% load upload_manager_tags %}
{% upload_manager tresource %}
{% endif %}


Available translations:
<ul style="width:500px">
{% for language,count in translated_languages.items %}
    <li style="list-style:none">
		<a href="{% url translation project.slug tresource.slug language.code %}">{{language}}</a><sup>{{count}}</sup>
        {% with 200 as barwidth %}
            <div class="stats tipsy_enable" style='float:right;width:{{ barwidth|add:"2" }}px;' title="{% trans "Translated: " %}{% translated tresource language.code %}<br />{% trans "Untranslated: " %}{% untranslated tresource language.code %}">
                <div class="stats_string_comp" >{% trans_percent tresource language.code %}% <span class='trans_detail'>({% translated tresource language.code %}/{% untranslated tresource language.code %})</span></div> 
                {% stats_bar_simple tresource language.code barwidth %}
            </div>
        {% endwith %}
    </li>
{% endfor %}
</ul>

<!-- This is just to show how it could be handled easily. Needs polishing!! -->
<a id="new_translation" class="buttonized i16">Start New Translation</a>

<div id="new_translation_box" style="display:none; padding:1em; margin:0; border:1px solid; border-color:#CCC;">

    <select name="{{ language.code }}" class="language">
        <option value="">Select Language</option>
        {% for lang in languages %}
            <option value="{{ lang.code }}">{{ lang.name }}</option>
        {% endfor %}
    </select>

    <a id="start_new_translation" class="i16 buttonized add">Create</a>
</div>


{% endblock %}

{% block content_footer %}
{% endblock %}
